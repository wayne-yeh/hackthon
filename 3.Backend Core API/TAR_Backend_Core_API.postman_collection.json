{
  "info": {
    "name": "TAR Backend Core API",
    "description": "Tokenized Asset Receipt Backend Core API Collection",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
    "version": "1.0.0"
  },
  "auth": {
    "type": "apikey",
    "apikey": [
      {
        "key": "key",
        "value": "X-API-Key",
        "type": "string"
      },
      {
        "key": "value",
        "value": "change-this-in-production",
        "type": "string"
      },
      {
        "key": "in",
        "value": "header",
        "type": "string"
      }
    ]
  },
  "variable": [
    {
      "key": "baseUrl",
      "value": "http://localhost:8080",
      "type": "string"
    },
    {
      "key": "apiKey",
      "value": "change-this-in-production",
      "type": "string"
    },
    {
      "key": "tokenId",
      "value": "650575",
      "type": "string"
    },
    {
      "key": "ownerAddress",
      "value": "0x1234567890123456789012345678901234567890",
      "type": "string"
    },
    {
      "key": "metadataHash",
      "value": "8c8e949a6debccd9a3a1e4e1c9daba7a46b69bd65a43cacdc71c535fe9b6e94f",
      "type": "string"
    }
  ],
  "item": [
    {
      "name": "Health Check",
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "{{baseUrl}}/actuator/health",
          "host": ["{{baseUrl}}"],
          "path": ["actuator", "health"]
        },
        "description": "Check if the service is running"
      },
      "response": [
        {
          "name": "Success",
          "originalRequest": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/actuator/health",
              "host": ["{{baseUrl}}"],
              "path": ["actuator", "health"]
            }
          },
          "status": "OK",
          "code": 200,
          "_postman_previewlanguage": "json",
          "header": [
            {
              "key": "Content-Type",
              "value": "application/json"
            }
          ],
          "cookie": [],
          "body": "{\"status\":\"UP\"}"
        }
      ]
    },
    {
      "name": "Issue Receipt",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          },
          {
            "key": "X-API-Key",
            "value": "{{apiKey}}"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"invoiceNo\": \"INV-001\",\n  \"purchaseDate\": \"2024-01-01\",\n  \"amount\": 100.50,\n  \"itemName\": \"Gold Bar\",\n  \"ownerAddress\": \"{{ownerAddress}}\",\n  \"description\": \"High purity gold bar\",\n  \"metadata\": {\n    \"purity\": \"99.9%\",\n    \"weight\": \"100g\"\n  }\n}"
        },
        "url": {
          "raw": "{{baseUrl}}/api/v1/receipts/issue",
          "host": ["{{baseUrl}}"],
          "path": ["api", "v1", "receipts", "issue"]
        },
        "description": "Issue a new TAR receipt"
      },
      "response": [
        {
          "name": "Success",
          "originalRequest": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "X-API-Key",
                "value": "{{apiKey}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"invoiceNo\": \"INV-001\",\n  \"purchaseDate\": \"2024-01-01\",\n  \"amount\": 100.50,\n  \"itemName\": \"Gold Bar\",\n  \"ownerAddress\": \"{{ownerAddress}}\",\n  \"description\": \"High purity gold bar\",\n  \"metadata\": {\n    \"purity\": \"99.9%\",\n    \"weight\": \"100g\"\n  }\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/receipts/issue",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "receipts", "issue"]
            }
          },
          "status": "OK",
          "code": 200,
          "_postman_previewlanguage": "json",
          "header": [
            {
              "key": "Content-Type",
              "value": "application/json"
            }
          ],
          "cookie": [],
          "body": "{\n  \"tokenId\": 650575,\n  \"transactionHash\": \"0x19a21ae1e8f\",\n  \"metadataUri\": \"ipfs://0edec501-c45b-4397-b73a-58d9d8756717\",\n  \"metadataHash\": \"8c8e949a6debccd9a3a1e4e1c9daba7a46b69bd65a43cacdc71c535fe9b6e94f\",\n  \"ownerAddress\": \"0x1234567890123456789012345678901234567890\",\n  \"success\": true,\n  \"message\": \"Receipt issued successfully\"\n}"
        }
      ]
    },
    {
      "name": "Verify Receipt",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"tokenId\": {{tokenId}},\n  \"metadataHash\": \"{{metadataHash}}\"\n}"
        },
        "url": {
          "raw": "{{baseUrl}}/api/v1/receipts/verify",
          "host": ["{{baseUrl}}"],
          "path": ["api", "v1", "receipts", "verify"]
        },
        "description": "Verify receipt validity"
      },
      "response": [
        {
          "name": "Success",
          "originalRequest": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"tokenId\": {{tokenId}},\n  \"metadataHash\": \"{{metadataHash}}\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/receipts/verify",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "receipts", "verify"]
            }
          },
          "status": "OK",
          "code": 200,
          "_postman_previewlanguage": "json",
          "header": [
            {
              "key": "Content-Type",
              "value": "application/json"
            }
          ],
          "cookie": [],
          "body": "{\n  \"valid\": true,\n  \"tokenId\": 650575,\n  \"ownerAddress\": \"0x1234567890123456789012345678901234567890\",\n  \"revoked\": false,\n  \"metadataHash\": \"8c8e949a6debccd9a3a1e4e1c9daba7a46b69bd65a43cacdc71c535fe9b6e94f\",\n  \"hashMatches\": true,\n  \"message\": \"Receipt is valid\",\n  \"verifiedAt\": \"2025-10-27T02:00:52.285977\"\n}"
        }
      ]
    },
    {
      "name": "Get Receipt Details",
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "{{baseUrl}}/api/v1/receipts/{{tokenId}}/details",
          "host": ["{{baseUrl}}"],
          "path": ["api", "v1", "receipts", "{{tokenId}}", "details"]
        },
        "description": "Get receipt details by token ID"
      },
      "response": [
        {
          "name": "Success",
          "originalRequest": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/v1/receipts/{{tokenId}}/details",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "receipts", "{{tokenId}}", "details"]
            }
          },
          "status": "OK",
          "code": 200,
          "_postman_previewlanguage": "json",
          "header": [
            {
              "key": "Content-Type",
              "value": "application/json"
            }
          ],
          "cookie": [],
          "body": "{\n  \"tokenId\": 650575,\n  \"invoiceNo\": \"INV-001\",\n  \"purchaseDate\": \"2024-01-01\",\n  \"amount\": 100.50,\n  \"itemName\": \"Gold Bar\",\n  \"ownerAddress\": \"0x1234567890123456789012345678901234567890\",\n  \"metadataUri\": \"ipfs://0edec501-c45b-4397-b73a-58d9d8756717\",\n  \"metadataHash\": \"8c8e949a6debccd9a3a1e4e1c9daba7a46b69bd65a43cacdc71c535fe9b6e94f\",\n  \"transactionHash\": \"0x19a21ae1e8f\",\n  \"revoked\": false,\n  \"createdAt\": \"2025-10-27T02:00:50.579424\",\n  \"revokedAt\": null\n}"
        }
      ]
    },
    {
      "name": "Revoke Receipt",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          },
          {
            "key": "X-API-Key",
            "value": "{{apiKey}}"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": ""
        },
        "url": {
          "raw": "{{baseUrl}}/api/v1/receipts/{{tokenId}}/revoke",
          "host": ["{{baseUrl}}"],
          "path": ["api", "v1", "receipts", "{{tokenId}}", "revoke"]
        },
        "description": "Revoke a receipt"
      },
      "response": [
        {
          "name": "Success",
          "originalRequest": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "X-API-Key",
                "value": "{{apiKey}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": ""
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/receipts/{{tokenId}}/revoke",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "receipts", "{{tokenId}}", "revoke"]
            }
          },
          "status": "OK",
          "code": 200,
          "_postman_previewlanguage": "text",
          "header": [
            {
              "key": "Content-Type",
              "value": "text/plain;charset=UTF-8"
            }
          ],
          "cookie": [],
          "body": "Receipt revoked successfully"
        }
      ]
    },
    {
      "name": "Get Owner's All Receipts",
      "request": {
        "method": "GET",
        "header": [
          {
            "key": "X-API-Key",
            "value": "{{apiKey}}"
          }
        ],
        "url": {
          "raw": "{{baseUrl}}/api/v1/receipts/owner/{{ownerAddress}}",
          "host": ["{{baseUrl}}"],
          "path": ["api", "v1", "receipts", "owner", "{{ownerAddress}}"]
        },
        "description": "Get all receipts owned by an address"
      },
      "response": [
        {
          "name": "Success",
          "originalRequest": {
            "method": "GET",
            "header": [
              {
                "key": "X-API-Key",
                "value": "{{apiKey}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/v1/receipts/owner/{{ownerAddress}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "receipts", "owner", "{{ownerAddress}}"]
            }
          },
          "status": "OK",
          "code": 200,
          "_postman_previewlanguage": "json",
          "header": [
            {
              "key": "Content-Type",
              "value": "application/json"
            }
          ],
          "cookie": [],
          "body": "[\n  {\n    \"tokenId\": 650575,\n    \"invoiceNo\": \"INV-001\",\n    \"purchaseDate\": \"2024-01-01\",\n    \"amount\": 100.50,\n    \"itemName\": \"Gold Bar\",\n    \"ownerAddress\": \"0x1234567890123456789012345678901234567890\",\n    \"metadataUri\": \"ipfs://0edec501-c45b-4397-b73a-58d9d8756717\",\n    \"metadataHash\": \"8c8e949a6debccd9a3a1e4e1c9daba7a46b69bd65a43cacdc71c535fe9b6e94f\",\n    \"transactionHash\": \"0x19a21ae1e8f\",\n    \"revoked\": true,\n    \"createdAt\": \"2025-10-27T02:00:50.579424\",\n    \"revokedAt\": \"2025-10-27T02:00:55.326456\"\n  }\n]"
        }
      ]
    },
    {
      "name": "Get Owner's Active Receipts",
      "request": {
        "method": "GET",
        "header": [
          {
            "key": "X-API-Key",
            "value": "{{apiKey}}"
          }
        ],
        "url": {
          "raw": "{{baseUrl}}/api/v1/receipts/owner/{{ownerAddress}}/active",
          "host": ["{{baseUrl}}"],
          "path": ["api", "v1", "receipts", "owner", "{{ownerAddress}}", "active"]
        },
        "description": "Get active (non-revoked) receipts owned by an address"
      },
      "response": [
        {
          "name": "Success",
          "originalRequest": {
            "method": "GET",
            "header": [
              {
                "key": "X-API-Key",
                "value": "{{apiKey}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/v1/receipts/owner/{{ownerAddress}}/active",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "receipts", "owner", "{{ownerAddress}}", "active"]
            }
          },
          "status": "OK",
          "code": 200,
          "_postman_previewlanguage": "json",
          "header": [
            {
              "key": "Content-Type",
              "value": "application/json"
            }
          ],
          "cookie": [],
          "body": "[]"
        }
      ]
    },
    {
      "name": "Error Tests",
      "item": [
        {
          "name": "Invalid API Key",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "X-API-Key",
                "value": "invalid-key"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"invoiceNo\": \"INV-002\",\n  \"purchaseDate\": \"2024-01-01\",\n  \"amount\": 50.0,\n  \"itemName\": \"Silver Coin\",\n  \"ownerAddress\": \"{{ownerAddress}}\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/receipts/issue",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "receipts", "issue"]
            },
            "description": "Test with invalid API key"
          },
          "response": [
            {
              "name": "Forbidden",
              "originalRequest": {
                "method": "POST",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  },
                  {
                    "key": "X-API-Key",
                    "value": "invalid-key"
                  }
                ],
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"invoiceNo\": \"INV-002\",\n  \"purchaseDate\": \"2024-01-01\",\n  \"amount\": 50.0,\n  \"itemName\": \"Silver Coin\",\n  \"ownerAddress\": \"{{ownerAddress}}\"\n}"
                },
                "url": {
                  "raw": "{{baseUrl}}/api/v1/receipts/issue",
                  "host": ["{{baseUrl}}"],
                  "path": ["api", "v1", "receipts", "issue"]
                }
              },
              "status": "Forbidden",
              "code": 403,
              "_postman_previewlanguage": "text",
              "header": [],
              "cookie": [],
              "body": ""
            }
          ]
        },
        {
          "name": "Missing Required Fields",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "X-API-Key",
                "value": "{{apiKey}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"invoiceNo\": \"INV-003\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/receipts/issue",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "receipts", "issue"]
            },
            "description": "Test with missing required fields"
          },
          "response": [
            {
              "name": "Bad Request",
              "originalRequest": {
                "method": "POST",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  },
                  {
                    "key": "X-API-Key",
                    "value": "{{apiKey}}"
                  }
                ],
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"invoiceNo\": \"INV-003\"\n}"
                },
                "url": {
                  "raw": "{{baseUrl}}/api/v1/receipts/issue",
                  "host": ["{{baseUrl}}"],
                  "path": ["api", "v1", "receipts", "issue"]
                }
              },
              "status": "Bad Request",
              "code": 400,
              "_postman_previewlanguage": "json",
              "header": [
                {
                  "key": "Content-Type",
                  "value": "application/json"
                }
              ],
              "cookie": [],
              "body": "{\n  \"message\": \"Validation failed\",\n  \"errors\": {\n    \"itemName\": \"Item name is required\",\n    \"purchaseDate\": \"Purchase date is required\",\n    \"amount\": \"Amount is required\",\n    \"ownerAddress\": \"Owner address is required\"\n  },\n  \"timestamp\": \"2025-10-27T02:00:00.000000\",\n  \"status\": 400\n}"
            }
          ]
        },
        {
          "name": "Non-existent Receipt",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/v1/receipts/999999/details",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "receipts", "999999", "details"]
            },
            "description": "Test with non-existent receipt ID"
          },
          "response": [
            {
              "name": "Not Found",
              "originalRequest": {
                "method": "GET",
                "header": [],
                "url": {
                  "raw": "{{baseUrl}}/api/v1/receipts/999999/details",
                  "host": ["{{baseUrl}}"],
                  "path": ["api", "v1", "receipts", "999999", "details"]
                }
              },
              "status": "Not Found",
              "code": 404,
              "_postman_previewlanguage": "json",
              "header": [
                {
                  "key": "Content-Type",
                  "value": "application/json"
                }
              ],
              "cookie": [],
              "body": "{\n  \"message\": \"Receipt not found\",\n  \"timestamp\": \"2025-10-27T02:00:00.000000\",\n  \"status\": 404\n}"
            }
          ]
        }
      ]
    }
  ],
  "event": [
    {
      "listen": "prerequest",
      "script": {
        "type": "text/javascript",
        "exec": [
          "// Auto-generate unique invoice number for testing",
          "if (pm.request.url.path.includes('issue')) {",
          "    const timestamp = Date.now();",
          "    pm.environment.set('invoiceNo', `INV-${timestamp}`);",
          "}"
        ]
      }
    },
    {
      "listen": "test",
      "script": {
        "type": "text/javascript",
        "exec": [
          "// Auto-extract tokenId from issue receipt response",
          "if (pm.response.code === 200 && pm.request.url.path.includes('issue')) {",
          "    const responseJson = pm.response.json();",
          "    if (responseJson.tokenId) {",
          "        pm.environment.set('tokenId', responseJson.tokenId);",
          "        pm.environment.set('metadataHash', responseJson.metadataHash);",
          "    }",
          "}",
          "",
          "// Test response structure",
          "pm.test('Response time is less than 5000ms', function () {",
          "    pm.expect(pm.response.responseTime).to.be.below(5000);",
          "});",
          "",
          "pm.test('Response has correct content type', function () {",
          "    pm.expect(pm.response.headers.get('Content-Type')).to.include('application/json');",
          "});"
        ]
      }
    }
  ]
}
