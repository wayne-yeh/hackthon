# TAR å…ƒæ•¸æ“šæœå‹™ - å¿«é€Ÿå…¥é–€æŒ‡å—

## ğŸš€ 5 åˆ†é˜å¿«é€Ÿé–‹å§‹

### æ­¥é©Ÿ 1: ç’°å¢ƒæº–å‚™

```bash
# é€²å…¥å°ˆæ¡ˆç›®éŒ„
cd "2.Metadata Service"

# æª¢æŸ¥ Java ç‰ˆæœ¬ (éœ€è¦ Java 17+)
java -version

# æª¢æŸ¥ Maven ç‰ˆæœ¬
mvn -version
```

### æ­¥é©Ÿ 2: é‹è¡Œæ¸¬è©¦

```bash
# é‹è¡Œæ‰€æœ‰æ¸¬è©¦
mvn test

# é‹è¡Œæ¸¬è©¦ä¸¦ç”Ÿæˆè¦†è“‹ç‡å ±å‘Š
mvn test jacoco:report
```

### æ­¥é©Ÿ 3: å•Ÿå‹•æœå‹™

```bash
# æ–¹å¼ 1: ä½¿ç”¨ Maven é‹è¡Œ
mvn spring-boot:run

# æ–¹å¼ 2: ä½¿ç”¨ JAR æ–‡ä»¶é‹è¡Œ
mvn clean package -DskipTests
java -jar target/metadata-service-0.0.1-SNAPSHOT.jar
```

### æ­¥é©Ÿ 4: æ¸¬è©¦ API ç«¯é»

```bash
# æ¸¬è©¦å¥åº·æª¢æŸ¥
curl http://localhost:8081/actuator/health

# ä¸Šå‚³æ”¶æ“šå…ƒæ•¸æ“š
curl -X POST "http://localhost:8081/api/metadata/receipts" \
  -F "invoiceNo=TEST-001" \
  -F "purchaseDate=2023-10-24" \
  -F "amount=1000.00" \
  -F "itemName=Test Item" \
  -F "ownerAddress=0x1234567890123456789012345678901234567890"

# é©—è­‰å…ƒæ•¸æ“šå“ˆå¸Œ
curl "http://localhost:8081/api/metadata/hash?url=ipfs://<metadata_url>"
```

### æ­¥é©Ÿ 5: æŸ¥çœ‹ API æ–‡æª”

```bash
# è¨ªå• Swagger UI
open http://localhost:8081/swagger-ui.html
```

## ğŸ¯ æ ¸å¿ƒæ¦‚å¿µ

### ä»€éº¼æ˜¯å…ƒæ•¸æ“šæœå‹™ï¼Ÿ

TAR å…ƒæ•¸æ“šæœå‹™è² è²¬ç®¡ç†å’Œå­˜å„² TAR æ”¶æ“šçš„å…ƒæ•¸æ“šï¼Œæä¾›ï¼š

- **å…ƒæ•¸æ“šå­˜å„²**: å®‰å…¨å­˜å„²æ”¶æ“šçš„è©³ç´°ä¿¡æ¯
- **å“ˆå¸Œé©—è­‰**: ç¢ºä¿å…ƒæ•¸æ“šçš„å®Œæ•´æ€§å’Œä¸å¯ç¯¡æ”¹æ€§
- **å¯æ’æ‹”å­˜å„²**: æ”¯æŒ S3 å’Œ IPFS å­˜å„²å¾Œç«¯
- **REST API**: æä¾›æ¨™æº–åŒ–çš„ API æ¥å£

### ä¸»è¦åŠŸèƒ½

- **ä¸Šå‚³å…ƒæ•¸æ“š**: æ¥æ”¶ä¸¦å­˜å„²æ”¶æ“šå…ƒæ•¸æ“š
- **å“ˆå¸Œè¨ˆç®—**: è¨ˆç®—å…ƒæ•¸æ“šçš„ SHA-256 å“ˆå¸Œ
- **å“ˆå¸Œé©—è­‰**: é©—è­‰å…ƒæ•¸æ“šçš„å®Œæ•´æ€§
- **æ–‡ä»¶ä¸‹è¼‰**: ä¸‹è¼‰å­˜å„²çš„æ–‡ä»¶

## ğŸ”§ å¸¸ç”¨æ“ä½œ

### 1. ä¸Šå‚³æ”¶æ“šå…ƒæ•¸æ“š

```bash
curl -X POST "http://localhost:8081/api/metadata/receipts" \
  -F "invoiceNo=INV-2023-001" \
  -F "purchaseDate=2023-10-24" \
  -F "amount=5000.00" \
  -F "itemName=å°åŒ—101è¾¦å…¬å®¤" \
  -F "ownerAddress=0x1234567890123456789012345678901234567890" \
  -F "image=@office.jpg"
```

**å›æ‡‰**:

```json
{
  "metadataUrl": "ipfs://abc123-def456-ghi789",
  "metaHash": "a1b2c3d4e5f6789012345678901234567890abcdef1234567890abcdef123456"
}
```

### 2. é©—è­‰å…ƒæ•¸æ“šå“ˆå¸Œ

```bash
curl "http://localhost:8081/api/metadata/hash?url=ipfs://abc123-def456-ghi789"
```

**å›æ‡‰**:

```json
{
  "metaHash": "a1b2c3d4e5f6789012345678901234567890abcdef1234567890abcdef123456"
}
```

### 3. ä¸‹è¼‰æ–‡ä»¶

```bash
curl "http://localhost:8081/api/metadata/download?key=metadata/metadata_INV-001_uuid.json"
```

## ğŸ“Š å¯¦éš›ä½¿ç”¨å ´æ™¯

### å ´æ™¯ 1: æˆ¿åœ°ç”¢æ”¶æ“šå…ƒæ•¸æ“š

```json
{
  "invoiceNo": "RE-2023-001",
  "purchaseDate": "2023-10-24",
  "amount": 50000000,
  "itemName": "å°åŒ—101è¾¦å…¬å®¤",
  "ownerAddress": "0x1234567890123456789012345678901234567890",
  "imageUrl": "ipfs://office-image-hash",
  "timestamp": 1698105600000
}
```

### å ´æ™¯ 2: è—è¡“å“æ”¶æ“šå…ƒæ•¸æ“š

```json
{
  "invoiceNo": "ART-2023-001",
  "purchaseDate": "2023-10-24",
  "amount": 1000000,
  "itemName": "è’™å¨œéº—èè¤‡è£½å“",
  "ownerAddress": "0x1234567890123456789012345678901234567890",
  "imageUrl": "ipfs://artwork-image-hash",
  "timestamp": 1698105600000
}
```

### å ´æ™¯ 3: å¥¢ä¾ˆå“æ”¶æ“šå…ƒæ•¸æ“š

```json
{
  "invoiceNo": "LUX-2023-001",
  "purchaseDate": "2023-10-24",
  "amount": 500000,
  "itemName": "å‹åŠ›å£«æ‰‹éŒ¶",
  "ownerAddress": "0x1234567890123456789012345678901234567890",
  "imageUrl": "ipfs://watch-image-hash",
  "timestamp": 1698105600000
}
```

## ğŸ› ï¸ é–‹ç™¼å·¥å…·

### 1. ä½¿ç”¨ Makefile

```bash
# æŸ¥çœ‹æ‰€æœ‰å¯ç”¨å‘½ä»¤
make help

# é‹è¡Œæ¸¬è©¦
make test

# æ§‹å»ºæ‡‰ç”¨ç¨‹å¼
make build

# é‹è¡Œæ‡‰ç”¨ç¨‹å¼
make run

# Docker éƒ¨ç½²
make docker-run
```

### 2. ä½¿ç”¨ Maven å‘½ä»¤

```bash
# ç·¨è­¯å°ˆæ¡ˆ
mvn compile

# é‹è¡Œæ¸¬è©¦
mvn test

# æ‰“åŒ…æ‡‰ç”¨ç¨‹å¼
mvn package

# é‹è¡Œæ‡‰ç”¨ç¨‹å¼
mvn spring-boot:run

# æ¸…ç†å°ˆæ¡ˆ
mvn clean
```

### 3. ä½¿ç”¨ Docker

```bash
# æ§‹å»º Docker æ˜ åƒ
docker build -t metadata-service .

# é‹è¡Œå®¹å™¨
docker run -p 8081:8081 metadata-service

# ä½¿ç”¨ Docker Compose
docker-compose up -d
```

## ğŸ” æ•…éšœæ’é™¤

### å¸¸è¦‹å•é¡Œ

#### 1. ç«¯å£è¢«å ç”¨

```bash
# æª¢æŸ¥ç«¯å£ä½¿ç”¨æƒ…æ³
lsof -i :8081

# åœæ­¢å ç”¨ç«¯å£çš„é€²ç¨‹
kill -9 <PID>
```

#### 2. Java ç‰ˆæœ¬å•é¡Œ

```bash
# æª¢æŸ¥ Java ç‰ˆæœ¬
java -version

# éœ€è¦ Java 17 æˆ–æ›´é«˜ç‰ˆæœ¬
# å¦‚æœç‰ˆæœ¬ä¸ç¬¦ï¼Œè«‹å®‰è£æ­£ç¢ºçš„ Java ç‰ˆæœ¬
```

#### 3. Maven ä¾è³´å•é¡Œ

```bash
# æ¸…ç†ä¸¦é‡æ–°ä¸‹è¼‰ä¾è³´
mvn clean install

# å¼·åˆ¶æ›´æ–°ä¾è³´
mvn clean install -U
```

#### 4. å­˜å„²é…ç½®å•é¡Œ

```bash
# æª¢æŸ¥é…ç½®æ–‡ä»¶
cat src/main/resources/application.yml

# ç¢ºä¿å­˜å„²é¡å‹é…ç½®æ­£ç¢º
# app.storage.type: ipfs  # æˆ– s3
```

### èª¿è©¦æŠ€å·§

#### 1. å•Ÿç”¨è©³ç´°æ—¥èªŒ

```yaml
# åœ¨ application.yml ä¸­æ·»åŠ 
logging:
  level:
    com.tar.metadata: DEBUG
    org.springframework.web: DEBUG
```

#### 2. ä½¿ç”¨å¥åº·æª¢æŸ¥

```bash
# æª¢æŸ¥æ‡‰ç”¨ç¨‹å¼ç‹€æ…‹
curl http://localhost:8081/actuator/health

# æŸ¥çœ‹è©³ç´°å¥åº·ä¿¡æ¯
curl http://localhost:8081/actuator/health | jq
```

#### 3. ç›£æ§ API è«‹æ±‚

```bash
# ä½¿ç”¨ curl çš„è©³ç´°æ¨¡å¼
curl -v -X POST "http://localhost:8081/api/metadata/receipts" \
  -F "invoiceNo=TEST-001" \
  -F "purchaseDate=2023-10-24" \
  -F "amount=1000.00" \
  -F "itemName=Test Item" \
  -F "ownerAddress=0x1234567890123456789012345678901234567890"
```

## ğŸ“š å­¸ç¿’è³‡æº

### 1. åŸºç¤æ¦‚å¿µ

- [Spring Boot å®˜æ–¹æ–‡æª”](https://spring.io/projects/spring-boot)
- [REST API è¨­è¨ˆæŒ‡å—](https://restfulapi.net/)
- [JSON æ ¼å¼è¦ç¯„](https://www.json.org/)

### 2. é–‹ç™¼å·¥å…·

- [Maven å®˜æ–¹æ–‡æª”](https://maven.apache.org/guides/)
- [Docker å®˜æ–¹æ–‡æª”](https://docs.docker.com/)
- [curl ä½¿ç”¨æŒ‡å—](https://curl.se/docs/)

### 3. å®‰å…¨æœ€ä½³å¯¦è¸

- [Spring Security æŒ‡å—](https://spring.io/guides/topicals/spring-security-architecture)
- [API å®‰å…¨æœ€ä½³å¯¦è¸](https://owasp.org/www-project-api-security/)

## ğŸ¯ ä¸‹ä¸€æ­¥

### 1. é›†æˆå…¶ä»–æœå‹™

- **Smart Contract Service**: é›†æˆæ™ºèƒ½åˆç´„æœå‹™
- **Backend Core API**: é›†æˆå¾Œç«¯æ ¸å¿ƒ API
- **Verification Service**: é›†æˆé©—è­‰æœå‹™

### 2. é…ç½®ç”Ÿç”¢ç’°å¢ƒ

```bash
# è¤‡è£½ç’°å¢ƒè®Šé‡æ¨¡æ¿
cp env.sample .env

# ç·¨è¼¯ç’°å¢ƒè®Šé‡
# é…ç½® S3 æˆ– IPFS å­˜å„²
# è¨­ç½®å®‰å…¨é…ç½®
```

### 3. ç›£æ§å’Œç¶­è­·

- è¨­ç½®æ‡‰ç”¨ç¨‹å¼ç›£æ§
- é…ç½®æ—¥èªŒèšåˆ
- å®šæœŸå‚™ä»½å…ƒæ•¸æ“š

## ğŸ†˜ ç²å–å¹«åŠ©

### 1. æŸ¥çœ‹æ–‡æª”

- `README.md` - å®Œæ•´ä½¿ç”¨æŒ‡å—
- `API_DOCUMENTATION.md` - API åƒè€ƒæ–‡æª”
- `å¿«é€Ÿå…¥é–€.md` - æœ¬æ–‡ä»¶

### 2. é‹è¡Œæ¸¬è©¦

```bash
# é‹è¡Œæ‰€æœ‰æ¸¬è©¦
mvn test

# é‹è¡Œç‰¹å®šæ¸¬è©¦
mvn test -Dtest=MetadataServiceTest
```

### 3. æª¢æŸ¥æ—¥èªŒ

```bash
# æŸ¥çœ‹æ‡‰ç”¨ç¨‹å¼æ—¥èªŒ
tail -f app.log

# æŸ¥çœ‹ Maven æ§‹å»ºæ—¥èªŒ
mvn spring-boot:run -X
```

---

**æ­å–œï¼æ‚¨å·²ç¶“æˆåŠŸè¨­ç½®äº† TAR å…ƒæ•¸æ“šæœå‹™ã€‚ç¾åœ¨å¯ä»¥é–‹å§‹ç®¡ç†æ‚¨çš„ä»£å¹£åŒ–è³‡ç”¢å…ƒæ•¸æ“šäº†ï¼**






