# TAR æ”¶æ“šåˆç´„æœå‹™ - å¿«é€Ÿå…¥é–€æŒ‡å—

## ğŸš€ 5 åˆ†é˜å¿«é€Ÿé–‹å§‹

### æ­¥é©Ÿ 1: ç’°å¢ƒæº–å‚™

```bash
# é€²å…¥å°ˆæ¡ˆç›®éŒ„
cd "1.Smart Contract Service"

# å®‰è£ä¾è³´
npm install
```

### æ­¥é©Ÿ 2: é‹è¡Œæ¸¬è©¦

```bash
# é‹è¡Œæ‰€æœ‰æ¸¬è©¦
npm run test

# æŸ¥çœ‹æ¸¬è©¦è¦†è“‹ç‡
npm run coverage
```

### æ­¥é©Ÿ 3: æœ¬åœ°éƒ¨ç½²

```bash
# å•Ÿå‹•æœ¬åœ°ç¯€é»ï¼ˆæ–°çµ‚ç«¯ï¼‰
npx hardhat node

# éƒ¨ç½²åˆç´„ï¼ˆå¦ä¸€å€‹çµ‚ç«¯ï¼‰
npm run deploy:local
```

### æ­¥é©Ÿ 4: è¨­ç½®ç™¼è¡Œè€…

```bash
npm run set-issuer
```

### æ­¥é©Ÿ 5: é‘„é€ ç¬¬ä¸€å€‹ TAR æ”¶æ“š

```bash
npm run mint
```

### æ­¥é©Ÿ 6: é©—è­‰æ”¶æ“š

```bash
npm run verify
```

## ğŸ¯ æ ¸å¿ƒæ¦‚å¿µ

### ä»€éº¼æ˜¯ TAR æ”¶æ“šï¼Ÿ

TAR (Tokenized Asset Receipt) æ”¶æ“šæ˜¯ä¸€ç¨®åŸºæ–¼å€å¡Šéˆçš„æ•¸å­—æ”¶æ“šï¼Œç”¨æ–¼è­‰æ˜å°å¯¦ç‰©è³‡ç”¢çš„æ‰€æœ‰æ¬Šæˆ–æ¬Šç›Šã€‚æ¯å€‹æ”¶æ“šéƒ½æ˜¯å”¯ä¸€çš„ NFTï¼ŒåŒ…å«ï¼š

- **å…ƒæ•¸æ“š**: è³‡ç”¢çš„è©³ç´°ä¿¡æ¯
- **å“ˆå¸Œé©—è­‰**: ç¢ºä¿å…ƒæ•¸æ“šå®Œæ•´æ€§
- **æ’¤éŠ·æ©Ÿåˆ¶**: å¿…è¦æ™‚å¯æ’¤éŠ·æ”¶æ“š
- **ç‰ˆç¨…æ”¯æŒ**: æ”¯æŒå‰µä½œè€…ç‰ˆç¨…

### ä¸»è¦è§’è‰²

- **ç®¡ç†å“¡ (Admin)**: åˆç´„æ‰€æœ‰è€…ï¼Œå¯ç®¡ç†è§’è‰²å’Œæš«åœåˆç´„
- **ç™¼è¡Œè€… (Issuer)**: å¯é‘„é€ å’Œæ’¤éŠ· TAR æ”¶æ“š
- **æŒæœ‰è€… (Holder)**: æ“æœ‰ TAR æ”¶æ“šçš„ç”¨æˆ¶

## ğŸ”§ å¸¸ç”¨æ“ä½œ

### 1. é‘„é€  TAR æ”¶æ“š

```typescript
// æº–å‚™å…ƒæ•¸æ“š
const metadata = {
  name: "æˆ¿åœ°ç”¢æ”¶æ“š #1",
  description: "å°åŒ—å¸‚ä¿¡ç¾©å€è±ªå®…æ”¶æ“š",
  image: "https://example.com/image.jpg",
  attributes: [
    { trait_type: "ä½ç½®", value: "å°åŒ—å¸‚ä¿¡ç¾©å€" },
    { trait_type: "é¢ç©", value: "100åª" },
    { trait_type: "åƒ¹å€¼", value: "5000è¬å°å¹£" },
  ],
};

// è¨ˆç®—å…ƒæ•¸æ“šå“ˆå¸Œ
const metadataHash = ethers.keccak256(
  ethers.toUtf8Bytes(JSON.stringify(metadata))
);

// é‘„é€ æ”¶æ“š
const tx = await tarReceipt.mint(
  buyerAddress,
  "https://example.com/metadata/1",
  metadataHash
);
```

### 2. é©—è­‰ TAR æ”¶æ“š

```typescript
// é©—è­‰æ”¶æ“š
const isValid = await tarReceipt.verify(tokenId, metadataHash);

if (isValid) {
  console.log("âœ… TAR æ”¶æ“šæœ‰æ•ˆ");
} else {
  console.log("âŒ TAR æ”¶æ“šç„¡æ•ˆ");
}
```

### 3. æ’¤éŠ· TAR æ”¶æ“š

```typescript
// æ’¤éŠ·æ”¶æ“š
const tx = await tarReceipt.revoke(tokenId);
console.log("æ”¶æ“šå·²æ’¤éŠ·");
```

## ğŸ“Š å¯¦éš›ä½¿ç”¨å ´æ™¯

### å ´æ™¯ 1: æˆ¿åœ°ç”¢ä»£å¹£åŒ–

```typescript
// æˆ¿åœ°ç”¢æ”¶æ“š
const realEstateMetadata = {
  name: "å°åŒ—101è¾¦å…¬å®¤æ”¶æ“š",
  description: "å°åŒ—101å¤§æ¨“ç¬¬50å±¤è¾¦å…¬å®¤æ‰€æœ‰æ¬Šè­‰æ˜",
  image: "https://example.com/taipei101.jpg",
  attributes: [
    { trait_type: "å»ºç¯‰ç‰©", value: "å°åŒ—101" },
    { trait_type: "æ¨“å±¤", value: "50æ¨“" },
    { trait_type: "é¢ç©", value: "200åª" },
    { trait_type: "åƒ¹å€¼", value: "1å„„å°å¹£" },
  ],
};
```

### å ´æ™¯ 2: è—è¡“å“ä»£å¹£åŒ–

```typescript
// è—è¡“å“æ”¶æ“š
const artworkMetadata = {
  name: "è’™å¨œéº—èæ”¶æ“š",
  description: "é”æ–‡è¥¿è’™å¨œéº—èç•«ä½œæ‰€æœ‰æ¬Šè­‰æ˜",
  image: "https://example.com/monalisa.jpg",
  attributes: [
    { trait_type: "è—è¡“å®¶", value: "é”æ–‡è¥¿" },
    { trait_type: "å¹´ä»½", value: "1503-1519" },
    { trait_type: "æè³ª", value: "æ²¹ç•«" },
    { trait_type: "åƒ¹å€¼", value: "8å„„ç¾å…ƒ" },
  ],
};
```

### å ´æ™¯ 3: å¥¢ä¾ˆå“ä»£å¹£åŒ–

```typescript
// å¥¢ä¾ˆå“æ”¶æ“š
const luxuryMetadata = {
  name: "å‹åŠ›å£«æ‰‹éŒ¶æ”¶æ“š",
  description: "å‹åŠ›å£« Submariner æ‰‹éŒ¶æ‰€æœ‰æ¬Šè­‰æ˜",
  image: "https://example.com/rolex.jpg",
  attributes: [
    { trait_type: "å“ç‰Œ", value: "å‹åŠ›å£«" },
    { trait_type: "å‹è™Ÿ", value: "Submariner" },
    { trait_type: "æè³ª", value: "ä¸é½é‹¼" },
    { trait_type: "åƒ¹å€¼", value: "50è¬å°å¹£" },
  ],
};
```

## ğŸ› ï¸ é–‹ç™¼å·¥å…·

### 1. ä½¿ç”¨ Makefile

```bash
# æŸ¥çœ‹æ‰€æœ‰å¯ç”¨å‘½ä»¤
make help

# å¿«é€Ÿè¨­ç½®é–‹ç™¼ç’°å¢ƒ
make dev-setup

# é‹è¡Œå®Œæ•´æ¸¬è©¦
make full-test

# å®Œæ•´éƒ¨ç½²æµç¨‹
make deploy-full
```

### 2. ä½¿ç”¨ npm è…³æœ¬

```bash
# ç·¨è­¯åˆç´„
npm run compile

# é‹è¡Œæ¸¬è©¦
npm run test

# ç”Ÿæˆè¦†è“‹ç‡å ±å‘Š
npm run coverage

# éƒ¨ç½²åˆ°æœ¬åœ°
npm run deploy:local

# éƒ¨ç½²åˆ° Sepolia
npm run deploy:sepolia
```

### 3. ç›´æ¥ä½¿ç”¨ Hardhat

```bash
# ç·¨è­¯
npx hardhat compile

# æ¸¬è©¦
npx hardhat test

# éƒ¨ç½²
npx hardhat run scripts/deploy.ts --network localhost

# æ§åˆ¶å°
npx hardhat console --network localhost
```

## ğŸ” æ•…éšœæ’é™¤

### å¸¸è¦‹å•é¡Œ

#### 1. ç·¨è­¯éŒ¯èª¤

```bash
# æ¸…ç†ä¸¦é‡æ–°ç·¨è­¯
npx hardhat clean
npx hardhat compile
```

#### 2. æ¸¬è©¦å¤±æ•—

```bash
# é‹è¡Œå–®å€‹æ¸¬è©¦æ–‡ä»¶
npx hardhat test test/tarReceipt.spec.ts

# é‹è¡Œç‰¹å®šæ¸¬è©¦
npx hardhat test --grep "Should mint token successfully"
```

#### 3. éƒ¨ç½²å¤±æ•—

```bash
# æª¢æŸ¥ç¶²è·¯é€£æ¥
npx hardhat node

# æª¢æŸ¥å¸³æˆ¶é¤˜é¡
npx hardhat console --network localhost
> const [owner] = await ethers.getSigners()
> await ethers.provider.getBalance(owner.address)
```

#### 4. æ¬Šé™éŒ¯èª¤

```bash
# æª¢æŸ¥è§’è‰²
npx hardhat console --network localhost
> const tarReceipt = await ethers.getContractAt("TARReceipt", contractAddress)
> await tarReceipt.hasRole(await tarReceipt.ISSUER_ROLE(), issuerAddress)
```

### èª¿è©¦æŠ€å·§

#### 1. å•Ÿç”¨è©³ç´°æ—¥èªŒ

```bash
# é‹è¡Œæ¸¬è©¦æ™‚é¡¯ç¤ºè©³ç´°ä¿¡æ¯
npx hardhat test --verbose

# éƒ¨ç½²æ™‚é¡¯ç¤ºè©³ç´°ä¿¡æ¯
npx hardhat run scripts/deploy.ts --network localhost --verbose
```

#### 2. ä½¿ç”¨æ§åˆ¶å°

```bash
# å•Ÿå‹• Hardhat æ§åˆ¶å°
npx hardhat console --network localhost

# åœ¨æ§åˆ¶å°ä¸­æ¸¬è©¦åˆç´„
> const [owner, issuer, buyer] = await ethers.getSigners()
> const TARReceipt = await ethers.getContractFactory("TARReceipt")
> const tarReceipt = await TARReceipt.deploy("TAR", "TAR", owner.address)
> await tarReceipt.mint(buyer.address, "https://example.com/1", "0x1234")
```

#### 3. äº‹ä»¶ç›£è½

```typescript
// ç›£è½æ‰€æœ‰äº‹ä»¶
tarReceipt.on("*", (event) => {
  console.log("äº‹ä»¶:", event.event, event.args);
});

// ç›£è½ç‰¹å®šäº‹ä»¶
tarReceipt.on("Minted", (tokenId, to, metaHash) => {
  console.log(`ä»£å¹£ ${tokenId} å·²é‘„é€ çµ¦ ${to}`);
});
```

## ğŸ“š å­¸ç¿’è³‡æº

### 1. åŸºç¤æ¦‚å¿µ

- [ä»€éº¼æ˜¯ NFTï¼Ÿ](https://ethereum.org/zh/nft/)
- [ERC-721 æ¨™æº–](https://eips.ethereum.org/EIPS/eip-721)
- [æ™ºèƒ½åˆç´„åŸºç¤](https://ethereum.org/zh/developers/docs/smart-contracts/)

### 2. é–‹ç™¼å·¥å…·

- [Hardhat æ–‡æª”](https://hardhat.org/docs)
- [ethers.js æ–‡æª”](https://docs.ethers.io/)
- [OpenZeppelin æ–‡æª”](https://docs.openzeppelin.com/)

### 3. å®‰å…¨æœ€ä½³å¯¦è¸

- [Solidity å®‰å…¨æŒ‡å—](https://consensys.github.io/smart-contract-best-practices/)
- [OpenZeppelin å®‰å…¨æŒ‡å—](https://docs.openzeppelin.com/contracts/security)

## ğŸ¯ ä¸‹ä¸€æ­¥

### 1. é›†æˆå…¶ä»–æœå‹™

- **Backend Core API**: é›†æˆå¾Œç«¯ API æœå‹™
- **Metadata Service**: é›†æˆå…ƒæ•¸æ“šå­˜å„²æœå‹™
- **Verification Service**: é›†æˆé©—è­‰æœå‹™

### 2. éƒ¨ç½²åˆ°æ¸¬è©¦ç¶²

```bash
# é…ç½®ç’°å¢ƒè®Šé‡
cp env.sample .env
# ç·¨è¼¯ .env æ–‡ä»¶

# éƒ¨ç½²åˆ° Sepolia
npm run deploy:sepolia
```

### 3. ç›£æ§å’Œç¶­è­·

- è¨­ç½®äº‹ä»¶ç›£è½
- é…ç½®è­¦å ±ç³»çµ±
- å®šæœŸå®‰å…¨å¯©è¨ˆ

## ğŸ†˜ ç²å–å¹«åŠ©

### 1. æŸ¥çœ‹æ–‡æª”

- `README_CN.md` - ä¸­æ–‡ä½¿ç”¨æŒ‡å—
- `æŠ€è¡“æ–‡æª”.md` - è©³ç´°æŠ€è¡“æ–‡æª”
- `APIåƒè€ƒ.md` - å®Œæ•´ API åƒè€ƒ

### 2. é‹è¡Œæ¸¬è©¦

```bash
# é‹è¡Œæ‰€æœ‰æ¸¬è©¦
npm run test

# ç”Ÿæˆè¦†è“‹ç‡å ±å‘Š
npm run coverage
```

### 3. æª¢æŸ¥æ—¥èªŒ

```bash
# æŸ¥çœ‹éƒ¨ç½²æ—¥èªŒ
npm run deploy:local

# æŸ¥çœ‹æ¸¬è©¦æ—¥èªŒ
npm run test --verbose
```

---

**æ­å–œï¼æ‚¨å·²ç¶“æˆåŠŸè¨­ç½®äº† TAR æ”¶æ“šåˆç´„æœå‹™ã€‚ç¾åœ¨å¯ä»¥é–‹å§‹é–‹ç™¼æ‚¨çš„ä»£å¹£åŒ–è³‡ç”¢æ‡‰ç”¨ç¨‹åºäº†ï¼**

